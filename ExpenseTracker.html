<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expense Tracker</title>
  <style>
    .body {
    margin: 0;
    padding: 0;
  }
  .expensesform {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 20px;
  }
  table#addedexpenselist {
    display: flex;
    justify-content: center;
  }
  button.text-primary {
    margin: auto 3px auto 10px;
  }
  </style>
</head>

<body>
          <h1><center>Welcome to Expense Tracker Application</center></h1>
            <div class="expensesform">
              <div>
                <label for="addexpenseinput">Expense Amount</label>
                <input type="text" placeholder="Enter your task" id="addexpenseinput" required />
               </div>&#160&#160&#160&#160&#160
               <div>
                <label for="description">Expense Description</label>
                <input type="text" name="description" id="addexpensedescription" placeholder="enter expenses description" required />
               </div>&#160&#160&#160&#160&#160
               <div>
                <label for="category">Expense Category</label>
                <select id="addexpensecategory" name="category" required>
                <option></option>
                <option value="Fuel">Fuel</option>
                <option value="Movie">Movie</option>
                <option value="Food">Food</option>
                <option value="Electricity">Electricity</option>
                </select>
                <input type="hidden" id="saveindex">
            </div>&#160&#160&#160&#160&#160&#160&#160
            <div>
              <button type="button" class="btn btn-success mr-sm-2" id="addexpensebtn" style="display: block;">
                Add Expense
              </button>  
              <button type="button" class="btn btn-success mr-sm-2" id="updateexpensebtn" style="display: none;" >
                Update Expense
              </button>
              </div> 
            </div>      
            <hr />
            <div>
              <table class="table table-striped mt-3 mb-0" id="addedexpenselist">
                
              </table>
            </div>

 // <script src="./script.js"></script>


 
<script>
  showexpenses();
let addexpenseinput = document.getElementById("addexpenseinput");
let addexpensedescription=document.getElementById("addexpensedescription");
let addexpensecategory=document.getElementById("addexpensecategory");
let addexpensebtn = document.getElementById("addexpensebtn");

addexpensebtn.addEventListener("click", function(){
    let addexpenseinputval = addexpenseinput.value;
    let addexpensedescriptionval = addexpensedescription.value;
    let addexpensecategoryval = addexpensecategory.value;
    if(addexpenseinputval.trim()!=0 && addexpensedescriptionval.trim()!=0 && addexpensecategoryval.trim()!=0){
        let webexpense = localStorage.getItem("localexpense");
        if(webexpense == null){
            expenseObj = [];
        }
        else{
            expenseObj = JSON.parse(webexpense);
        }
        expenseObj.push({'expenseamount':addexpenseinputval, 'expensedescription':addexpensedescriptionval, 'expensecategory':addexpensecategoryval});
        localStorage.setItem("localexpense", JSON.stringify(expenseObj));
        addexpenseinput.value = '';
        addexpensedescription.value='';
        addexpensecategory.value='';
    }
    showexpenses();
})

// showexpenses
function showexpenses(){
    let webexpense = localStorage.getItem("localexpense");
    if(webexpense == null){
        expenseObj = [];
    }
    else{
        expenseObj = JSON.parse(webexpense);
    }
    let html = '';
    let addedexpenselist = document.getElementById("addedexpenselist");
    expenseObj.forEach((item, index) => {

        html += `<tr>
                    <th scope="row">${index+1}</th>
                    <td>Rs ${item.expenseamount}  - ${item.expensedescription} - ${item.expensecategory}</td>
                    <td><button type="button" onclick="editexpense(${index})" class="text-primary"><i class="fa fa-edit"></i>Edit</button></td>
                    <td><button type="button" onclick="deleteexpense(${index})" class="text-danger"><i class="fa fa-trash"></i>Delete</button></td>
                </tr>`;
    });
    addedexpenselist.innerHTML = html;
}

// editexpense
function editexpense(index){
    let saveindex = document.getElementById("saveindex");
    let addexpensebtn = document.getElementById("addexpensebtn");
    saveindex.value = index;
    let webexpense = localStorage.getItem("localexpense");
    let expenseObj = JSON.parse(webexpense);     
    addexpenseinput.value = expenseObj[index]['expenseamount'];
    addexpensedescription.value=expenseObj[index]['expensedescription'];
    addexpensecategory.value=expenseObj[index]['expensecategory'];
    addexpensebtn.style.display="none";
    updateexpensebtn.style.display="block";

updateexpensebtn.addEventListener("click", function(){
    let webexpense = localStorage.getItem("localexpense");
    let expenseObj = JSON.parse(webexpense); 
    let saveindex = document.getElementById("saveindex").value;
    
    for (keys in expenseObj[saveindex]) {
        if(keys == 'expenseamount'){
            expenseObj[saveindex].expenseamount = addexpenseinput.value;
            expenseObj[saveindex].expensedescription = addexpensedescription.value;
            expenseObj[saveindex].expensecategory = addexpensecategory.value;
        }
      }
    if(addexpenseinput.value!=''){
    localStorage.setItem("localexpense", JSON.stringify(expenseObj));
    addexpenseinput.value='';
    addexpensedescription.value='';
    addexpensecategory.value='';
    addexpensebtn.style.display="block";
    updateexpensebtn.style.display="none";
    showexpenses();
    }
})
}

// deleteexpense
function deleteexpense(index){
    let webexpense = localStorage.getItem("localexpense");
    let expenseObj = JSON.parse(webexpense);
    expenseObj.splice(index, 1);
    localStorage.setItem("localexpense", JSON.stringify(expenseObj));
    showexpenses();
}
</script>

</body>
</html>
